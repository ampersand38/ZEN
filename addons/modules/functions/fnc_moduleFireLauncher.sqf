{#line 1 "x\zen\addons\modules\functions\fnc_moduleUnpackStaticWeapon.sqf"
#line 1 "x\zen\addons\modules\functions\script_component.hpp"
#line 1 "x\zen\addons\modules\script_component.hpp"


#line 1 "x\zen\addons\main\script_mod.hpp"





#line 1 "x\zen\addons\main\script_version.hpp"




#line 6 "x\zen\addons\main\script_mod.hpp"













#line 3 "x\zen\addons\modules\script_component.hpp"










#line 1 "x\zen\addons\main\script_macros.hpp"

#line 1 "x\cba\addons\main\script_macros_common.hpp"




















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#line 2 "x\zen\addons\main\script_macros.hpp"

#line 1 "x\cba\addons\xeh\script_xeh.hpp"














































































































#line 3 "x\zen\addons\main\script_macros.hpp"




































































































#line 1 "x\zen\addons\main\script_debug.hpp"

























#line 106 "x\zen\addons\main\script_macros.hpp"

#line 17 "x\zen\addons\modules\script_component.hpp"


#line 1 "a3\ui_f\hpp\defineDIKCodes.inc"






























































































































































































#line 19 "x\zen\addons\modules\script_component.hpp"

#line 1 "a3\ui_f\hpp\defineCommonGrids.inc"















































































































































































































































































































































































































































































#line 20 "x\zen\addons\modules\script_component.hpp"

#line 1 "x\zen\addons\common\defineResinclDesign.inc"
#line 1 "a3\ui_f\hpp\defineResincl.inc"









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#line 1 "x\zen\addons\common\defineResinclDesign.inc"































































































































































































































































































































































































































































































































































































































































#line 21 "x\zen\addons\modules\script_component.hpp"



















































































































































#line 1 "x\zen\addons\modules\functions\script_component.hpp"

#line 1 "x\zen\addons\modules\functions\fnc_moduleUnpackStaticWeapon.sqf"















zen_modules_fnc_moduleUnpackStaticWeapon = {

params ["_logic"];

private _gunner = attachedTo _logic;
deleteVehicle _logic;

if (isNull _gunner) exitWith {
["STR_zen_modules_NoUnitSelected"] call zen_common_fnc_showMessage;
};

if !(_gunner isKindOf "CAManBase") exitWith {
["STR_zen_modules_OnlyInfantry"] call zen_common_fnc_showMessage;
};

if !(alive _gunner) exitWith {
["STR_zen_modules_OnlyAlive"] call zen_common_fnc_showMessage;
};

if (isPlayer _gunner) exitWith {
["str_a3_cfgvehicles_moduleremotecontrol_f_errorPlayer"] call zen_common_fnc_showMessage;
};

getCompatibleBases = {
params ["_backpack"];
private _cfgBase = configFile >> "CfgVehicles" >> _backpack >> "assembleInfo" >> "base";
private _compatibleBases = if (isText _cfgBase) then {[getText _cfgBase]} else {getArray _cfgBase};
_compatibleBases
};

private _backpack = backpack _gunner;
systemChat _backpack;
if (_backpack isEqualTo "") exitWith {
    ["Unit must carry a weapon bag"] call zen_common_fnc_showMessage;
};

private _compatibleBases = [_backpack] call getCompatibleBases;
if (_compatibleBases isEqualType "") then {_compatibleBases = [_compatibleBases];};

private _backpackers = units _gunner select {!(backpack _x isEqualTo "")};
private _assistant = {
if (backpack _x in _compatibleBases) exitWith {_x};
if (_backpack in ([backpack _x] call getCompatibleBases)) exitWith {_x};

objNull
} forEach _backpackers;

if (_assistant isEqualTo objNull) exitWith {
["Unit group must contain two compatible weapon bags"] call zen_common_fnc_showMessage;
};


[_gunner, {
params ["_successful", "_gunner", "_mousePosASL", "_assistant"],;
[_gunner, _assistant, ASLToAGL _mousePosASL] remoteExecCall ["zen_modules_fnc_unpackStaticWeapon", _gunner];
}, _assistant, "Static Weapon Facing"] call zen_common_fnc_selectPosition;
}
